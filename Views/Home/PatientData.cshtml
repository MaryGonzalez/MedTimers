@*PATIENT DATA HOME PAGE*@
@*DISPLAYS ALL THE PATIENTS THAT HAVE ARRIVED AT THE HOSPITAL*@

<meta http-equiv="refresh" content="120" />
@model IEnumerable<MedTimers.Models.AllEdit>

<link rel="stylesheet" href="~/css/StyleSheet.css"/>
@{
    ViewData["Title"] = "MedTimers";
    Layout = "";
}
<link rel="shortcut icon" href="~/Images/clock.PNG" />

@*User access based on account type
    1 - Administrator
    2 - Nurse
    3 - Assessor
    4 - Sub Administrator
*@
   @if (ViewBag.userType == "1" || ViewBag.userType == "2" || ViewBag.userType == "3" || ViewBag.userType == "4")
{

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    
    <!--Date Time Now-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>

    @*Drop Down Menu*@
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>

    @*Fonts*@
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>

    <!--Pencil Icon Edit Button-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">

     <!--DataTable-->
     <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
     <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
     <link href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css" rel="stylesheet">
     <script type="text/javascript" src="https://cdn.datatables.net/fixedcolumns/3.2.2/js/dataTables.fixedColumns.min.js"></script>
       
     <!--Sweet Alert-->   
     <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

   
    <script src="~/js/site.js"></script>
    <script src="~/js/Transfers.js"></script>
    <link rel="stylesheet" href="~/css/PatientData.css"/>

</head>

<body>

        @{
            @*Convert current datetime to string*@
            DateTime dateNow = DateTime.Now;
            string dateString = dateNow.ToString("MM/dd/yyyy hh:mm tt");

            @*Convert a user's last log in datetime to string*@
            var logDate = DateTime.Parse(ViewBag.User_LastLogin);
            var logDateFormat = logDate.ToString("MM/dd/yyyy hh:mm tt");
        }

        <!--If a user is using the default password & has a LastLogin == current datetime-->
       @if (ViewBag.userPassword == "Zc!p2h@T" && logDateFormat == dateString)
        {
                <script>
                  Swal.fire({
                  title: 'Update your password', 
                  icon: 'warning',
                  showCancelButton: false,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: 'Update'
                }).then((result) => {
                  if (result.isConfirmed) {
                    @*Redirects user to UpdatePasswordSelf page*@                 
                    location.href='@Url.Action("UpdatePasswordSelf", "Home")'
                    
                  }
                })
                </script>
        }





        @{
            @*Default datetime for time stamps *@
            DateTime date = new DateTime(2000, 1, 1, 12, 0, 0);
            
            @*Default datetime for date of birth*@
            DateTime dob = new DateTime(1920, 1, 1);


            int homeCount = 0;
            int transferCount = 0;
            int certCount = 0;

            foreach(var item in Model)
            {
                @*Add 1 to the counter for Home if a patient's arrival datetime is not equal to the default date, 
                has an empty reason and an arrival type of walk-in, step up, or empty,
                has an arrival type of transfer or phone with empty admission type
                *@
                if (item.Track_InitialArrival != date && ((item.Track_Reason == "" && (item.Track_ArrivalType == "Walk-in" || item.Track_ArrivalType == "Step Up" || item.Track_ArrivalType == "")) || (item.Track_AdmissionType == "" && (item.Track_ArrivalType == "Transfer" || item.Track_ArrivalType == "Phone")) ) )
                {
                    homeCount++;
                }


                @*Add 1 to the counter for Transfer if the received referral is not equal to the default date
                has an arrival type of transfer or phone
                and the arrival time equals the default date (which means they havn't arrived at the hospital yet)*@
               if (item.Track_ReceivedReferral != date && (item.Track_ArrivalType == "Transfer" || item.Track_ArrivalType == "Phone" ) && item.Track_InitialArrival == date)
                {
                    transferCount++;
                }


                @*Add 1 to the counter for Cert if a patient's cert status equals deferred*@
                if (item.Track_CertStatus == "Deferred")
                {
                    certCount++;
                }
            }

        }
  

    <div class="row headTitle">
        <div class="col-sm-12 titlebox" style="background-color:#43444D; ">
            <div class="userLinks1">
                 @*Link to Home page*@
                <span><button type="button" class="button button-small userBtn" onclick="location.href='@Url.Action("PatientData", "Home")'">Home</button></span> |                
                
                @*Link to Transfers page*@
                <span><button type="button" class="button button-small userBtn" onclick="location.href='@Url.Action("Transfers", "Home")'">Transfers</button></span> |
                
                @*Link to Cert page*@
                <span><button type="button" class="button button-small userBtn" onclick="location.href='@Url.Action("Cert", "Home")'">Cert</button></span>


                @*Display Home count*@
                <p style="margin-left: 29px;">@homeCount</p>
                
                @*Display Transfer count*@
                <p style="margin-top: -28px; margin-left: 116px;">@transferCount</p>                
                
                @*Display Cert count*@
                <p style="margin-bottom: 9px; margin-left: 85%; margin-top: -29px;">@certCount</p>

            </div>

            @*User access based on account type, 1:Administrator*@
            @if (ViewBag.userType == "1")
            {
                <div class="userLinks2">
                    @*Link to Accounts page*@
                    <span><button type="button" class="button button-small userBtn" onclick="location.href='@Url.Action("Accounts", "Home")'">Accounts</button></span> |
                    
                    @*Link to Reports page*@
                    <span><button type="button" class="button button-small userBtn" onclick="location.href='@Url.Action("Reports", "Home")'">Reports</button></span>
                    </div>
                }
               
                @*Application title*@
                <p class="medTitle">MedTimers </p>

        </div>
    </div>

    @*Audio for new patient added to the table & is waiting*@
     <div id="audio-position" hidden>
       <audio controls id="makesound">
         <source src="~/js/soft-tone-001-9755.mp3" type="audio/mpeg"> 
        </audio>
     </div>

<div id="xyz">
  
</div>
  
    <div class="container-fluid">
        <div class="row">

            <div class="container-fluid">
                <div class="AllPatientData">
                    <div class="row">


                        <div class="col-sm-12 tableMargin">
                            <div class="homepageSearch">
                                @*Page title*@
                                 <a style="color:white">Home</a>

                                 @*+Add New Patient button*@
                                <button type="button" class="btn btn-outline-light addPatientBtn" onclick="location.href='@Url.Action("CreateNewPatient", "Home")'">+ ADD PATIENT</button>
                            </div>

                                <div class="row patientRow">
                                
                                <div class="column columnPatient">
                                    <table class="table patientTable" style="width:100%; table-layout:fixed;" id="patientTable">
                                        <thead>
                                            <tr>
                                                <th>Edit</th>
                                                <th>Arrival Time</th>
                                                <th>Name</th>
                                                <th>Preferred Name</th>
                                                <th>Age</th>
                                                <th>Sex</th>
                                                <th>Reason</th>
                                                <th>Arrival<br />Mode</th>
                                                <th>Arrival<br />Type</th>
                                                <th>Chief<br />Complaint</th>                                           

                                                <th class="tableSpace"></th>
                                                <th>Admission</th>
                                                <th>Triage</th>
                                                <th>SBAR Called</th>
                                                <th>Nurse</th>
                                                <th>MSE Assessment <br /> Start</th>
                                                <th>MSE Assessment <br /> End</th>
                                                <th>Assessment <br /> Wait Time</th>
                                                <th>Assessment Start</th>
                                                <th>Assessor</th>
                                                <th>Assessment<br />Room</th>
                                                <th>Assessment End</th>
                                                <th>Emergency <br />Medical Condition</th>
                                                <th>Cert Status</th>

                                                <th class="tableSpace"></th>

                                                <th>Arrival<br />To Disposition</th>
                                                <th>Disposition</th>
                                                <th>Time Patient<br /> Went to Unit</th>
                                                <th>Departure <br /> Mode</th>
                                                <th>Departure Time</th>
                                            </tr>
                                        </thead>
                                        <tbody id="homepageTableBody" >




                                            @if (Model != null)
                                            {
                                                @foreach (var item in Model) 

                                                @*If a patient has a null arrival time and arrival time is not equal to default date*@
                                                if (item.Track_InitialArrival != null && item.Track_InitialArrival != date)

                                                {
                                                <tr>

                                                    @*If a patient has an arrival type of walk-in and empty reason OR
                                                        if a patient has an arrival type of step up and empty reason OR
                                                        if a patient has an empty arrival type OR
                                                        if a patient has an arrival type of transfer and admission type empty OR
                                                        if a patient has an arrival type of phone and admission type empty
                                                    *@
                                                    @if((item.Track_ArrivalType == "Walk-in" && item.Track_Reason == "") || (item.Track_ArrivalType == "Step Up" && item.Track_Reason == "") || (item.Track_ArrivalType == "") || (item.Track_ArrivalType == "Transfer" && item.Track_AdmissionType == "") || (item.Track_ArrivalType == "Phone" && item.Track_AdmissionType == ""))
                                                    {
                                                        @*Alert noise if new patient has been added*@
                                                         <script>
                                                            var audio = $("#makesound")[0];
                                                            audio.play();
                                                            console.log(audio);
                                                          </script>

                                                                @*If a patient has an arrival type of walk-in and empty reason*@
                                                                @if(item.Track_ArrivalType == "Walk-in" && item.Track_Reason == "")
                                                                {                                                                  
                                                                    @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:red" class="fa fa-pencil"></i></a></td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.fullName)</td>

                                                                    @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null) 
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if(item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                       @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                         <td style="color:red">@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                    @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td class="test" style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                       @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ChiefComplaint != "Select")
                                                                    { 
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }



                                                                @*If a patient has an arrival type of step up or empty*@
                                                                 else if(item.Track_ArrivalType == "Step Up" && item.Track_Reason == "")
                                                                {
                                                                     @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:red" class="fa fa-pencil"></i></a></td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.fullName)</td>

                                                                      @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null) 
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                       @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if(item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                        @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                         <td style="color:red">@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                    @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                     @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ChiefComplaint != "Select")
                                                                    { 
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }



                                                                @*If a patient does not have an arrival type selected*@
                                                                 else if(item.Track_ArrivalType == "")
                                                                {
                                                                    @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:red" class="fa fa-pencil"></i></a></td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.fullName)</td>


                                                                    @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null) 
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                     @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if(item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                        @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                         <td style="color:red">@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                    @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                    @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ChiefComplaint != "Select")
                                                                    { 
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }


                                                                @*If a patient has an arrival type of transfer and no admission type selected*@
                                                                else if (item.Track_ArrivalType == "Transfer" && item.Track_AdmissionType == "")
                                                                {                             
                                                                     @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:red" class="fa fa-pencil"></i></a></td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.fullName)</td>

                                                                     @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null) 
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                     @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if(item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                        @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                         <td style="color:red">@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                     @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                    @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ChiefComplaint != "Select")
                                                                    { 
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }





                                                                @*If a patient has an arrival type of phone and no admission type*@
                                                                 else if (item.Track_ArrivalType == "Phone" && item.Track_AdmissionType == "")
                                                                {
                                                                     @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:red" class="fa fa-pencil"></i></a></td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.fullName)</td>

                                                                    @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null) 
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                     @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if(item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                        @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                         <td style="color:red">@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                    @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                    @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                     @if (item.Track_ChiefComplaint != "Select")
                                                                    { 
                                                                    <td style="color:red">@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }
                                                          }

                                                                else 
                                                                {
                                                                    @*Pencil icon to edit a patient*@
                                                                    <td><a href="@Url.Action("EditPatient", "Home", new { PatientID = item.PatientID })" class="button button-small editCertBtn"><i style="font-size:20px; color:black" class="fa fa-pencil"></i></a></td>
                                                                    <td>@Html.DisplayFor(modelItem => item.Track_InitialArrival)</td>
                                                                    <td>@Html.DisplayFor(modelItem => item.fullName)</td>


                                                                    @*If a patient does not have an empty preferred name or null
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_PreferredName != "" && item.Patient_PreferredName != null)
                                                                    {
                                                                        <td>@Html.DisplayFor(modelItem => item.Patient_PreferredName)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    @*If a patient's date of birth is not equal to the minimum date value or default date
                                                                      font color = red
                                                                    *@
                                                                    @if (item.Patient_DOB != DateTime.MinValue && item.Patient_DOB != dob)
                                                                    {
                                                                        @*Age is calculated in AllEdit model
                                                                         (Current date - DOB) - 365
                                                                         font color = red
                                                                       *@
                                                                        <td>@Html.DisplayFor(modelItem => item.Age)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }


                                                                    <td>@Html.DisplayFor(modelItem => item.Patient_Sex)</td>
                                                                    <td>@Html.DisplayFor(modelItem => item.Track_Reason)</td>

                                                                    @*Display arriaval mode if not equal to select
                                                                        font color = red
                                                                    *@
                                                                    @if (item.Track_ArrivalMode != "Select")
                                                                    {
                                                                        <td>@Html.DisplayFor(modelItem => item.Track_ArrivalMode)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }

                                                                    <td>@Html.DisplayFor(modelItem => item.Track_ArrivalType)</td>


                                                                    @*Display chief complaint if not equal to select
                                                                        font color = red
                                                                    *@
                                                                    @if (item.Track_ChiefComplaint != "Select")
                                                                    {
                                                                        <td>@Html.DisplayFor(modelItem => item.Track_ChiefComplaint)</td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td></td>
                                                                    }
                                                                }


                                                <td class="tableSpace"></td>

                                                @*If admission type is not 'select', display*@
                                                @if (item.Track_AdmissionType != "Select")
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_AdmissionType)</td>
                                                }
                                                else
                                                {
                                                    <td></td>
                                                }


                                                <td>
                                                    @*If triage level is low, display green low button*@
                                                    @if (item.Track_TriageLevel == "Low")
                                                    {
                                                        <button type="button" class="btn btn-primary triageBtn" style="background-color:#71BC78; width: 80px" id="green">Low</button>
                                                        <button type="button" class="close TriageCloseLowHigh" style="display:none" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    }
                                                    @*If triage level is medium, display yellow medium button*@
                                                    else if (item.Track_TriageLevel == "Medium")
                                                    {
                                                        <button type="button" class="btn btn-primary triageBtn" style="background-color: #EDD068; width: 80px" id="yellow">Medium</button>
                                                        <button type="button" class="close TriageCloseMedium" style="display:none" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    }
                                                    @*If triage level is high, display red high button*@
                                                    else if (item.Track_TriageLevel == "High")
                                                    {
                                                        <button type="button" class="btn btn-primary triageBtn" style="background-color:#EE3838; width: 80px" id="red">High</button>
                                                        <button type="button" class="close TriageCloseLowHigh" style="display:none" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    }

                                                </td>





                                                @* SBAR *@
                                                @*If patient SBAR datetime is not the minimum value and is not equal to the default date*@
                                                @if (item.Track_SBARCall != DateTime.MinValue && item.Track_SBARCall != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_SBARCall)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @* Nurse *@
                                                @*Populate the list of nurses from the database*@
                                                <td>@Html.DisplayFor(modelItem => item.fullNurse)</td>

                                                @* MSE Start Time *@
                                                @*If patient MSE Start Time datetime is not the minimum value and is not equal to the default date*@
                                                @if (item.Track_MSEStart != DateTime.MinValue && item.Track_MSEStart.Year != 2000)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_MSEStart)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }


                                                @* MSE End Time *@
                                                @*If patient MSE End Time datetime is not the minimum value and is not equal to the default date*@
                                                @if (item.Track_MSEEnd != DateTime.MinValue && item.Track_MSEEnd != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_MSEEnd)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @*Assessment Wait Time*@
                                                @*If patient MSE End Time datetime is not the minimum value and is not equal to the default date*@    
                                                @if (item.Track_MSEEnd != DateTime.MinValue && item.Track_MSEEnd != date)
                                                {
                                                    @*Calculated in AllEdit Model
                                                    Assessment Start Time minus MSE End Time
                                                    *@
                                                    <td>@Html.DisplayFor(modelItem => item.AssessmentWaitTime)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }



                                                @*Assessment Start Time*@
                                                @*If patient Assessment Start Time datetime is not the minimum value and is not equal to the default date*@
                                                @if (item.Assessment_StartTime != DateTime.MinValue && item.Assessment_StartTime != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Assessment_StartTime)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @*Assessor*@
                                                @*Populate the list of assessors from the database*@
                                                <td>@Html.DisplayFor(modelItem => item.fullAssessor)</td>

                                                @*Assessment Room*@
                                                @*If a patient has an assessment room not equal to 'Selec'*@
                                                @if (item.Assessment_Room != "Selec")
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Assessment_Room)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }



                                                @*Assessment End Time*@                                                
                                                @*If patient Assessment End Time datetime is not the minimum value and is not equal to the default date*@
                                                @if (item.Assessment_EndTime != DateTime.MinValue && item.Assessment_EndTime != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Assessment_EndTime)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @*Emergency Medical Condition*@
                                                <td>@Html.DisplayFor(modelItem => item.Track_EmergencyMedCondition)</td>



                                                @*Cert Status*@
                                                @*If a patient's cert status is not equal to 'Select'*@
                                                @if (item.Track_CertStatus != "Select")
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_CertStatus)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }



                                                <td class="tableSpace"></td>

                                                @*Disposition Arrival*@
                                                @if (item.Track_DispositionArrival != DateTime.MinValue && item.Track_DispositionArrival != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_DispositionArrival)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @*Disposition Type*@
                                                @if (item.Track_DispositionType != "Select")
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_DispositionType)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }


                                                @*Patient Went to Unit*@
                                                @if (item.Track_PatientWentToUnit != DateTime.MinValue && item.Track_PatientWentToUnit != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_PatientWentToUnit)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                                @*Departure Mode*@
                                                @if (item.Track_DepartureMode != "Select")
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_DepartureMode)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }


                                                @*Departure Time*@
                                                @if (item.Track_DepartureTime != DateTime.MinValue && item.Track_DepartureTime != date)
                                                {
                                                    <td>@Html.DisplayFor(modelItem => item.Track_DepartureTime)</td>
                                                }
                                                else
                                                @*Display empty cell*@
                                                {
                                                    <td></td>
                                                }

                                            </tr>
                                                    }
                                            }
                                            else
                                            @*If there is no patient data to display, show empty table*@
                                            {
                                                <tr>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                </div>


                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    @*Data Table*@
     <script>
          var table = $('#patientTable').DataTable({
         "ordering": false,
        "order": [],  // not set any order rule for any column.
        "scrollX": true,
        //Options for drop down menu - show entries
        "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],

        //Number of entries per page
        "pageLength": 10
    });
        </script>



</body>
</html> 
}
else
{     
  

 <div style="margin-left:44%; margin-top:8%">

  <div class='error-circle'>
    <div style="font-family: sans-serif;">X</div>
  </div>

  <h3 style="text-align:center; font-size:29px; margin-left:-84%; font-family: sans-serif;">Access Denied</h3>
  <p style="text-align:center; margin-left: -83%; font-size: 19px; font-family: sans-serif;">You do not have permission to view this page.</p>
  <p style="text-align:center; margin-left: -83%; font-size: 19px; font-family: sans-serif;">Please check your credentials and try again</p>
  <br>
  <a style="text-align:center; margin-left: 4%; font-size: 19px; font-family: sans-serif;" href="https://medtimers.cphmo.net/home/login">Login</a>
</div>
}